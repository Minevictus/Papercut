From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Nahuel <nahueldolores@hotmail.com>
Date: Tue, 28 Apr 2020 13:52:06 -0300
Subject: [PATCH] Add StructureGenerateEvent

---
 .../java/net/minecraft/server/ChunkGenerator.java     | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/src/main/java/net/minecraft/server/ChunkGenerator.java b/src/main/java/net/minecraft/server/ChunkGenerator.java
index ee6726e5c664115417c6397aa153315c8eb835a9..311032ed9f668734c14fae20aece315116dd13ab 100644
--- a/src/main/java/net/minecraft/server/ChunkGenerator.java
+++ b/src/main/java/net/minecraft/server/ChunkGenerator.java
@@ -1,5 +1,6 @@
 package net.minecraft.server;
 
+import com.destroystokyo.paper.event.world.StructureGenerateEvent; // Papercut
 import com.google.common.collect.Lists;
 import com.mojang.serialization.Codec;
 import java.util.BitSet;
@@ -9,6 +10,7 @@ import java.util.ListIterator;
 import java.util.Random;
 import java.util.function.Function;
 import javax.annotation.Nullable;
+import org.bukkit.StructureType; // Papercut
 
 public abstract class ChunkGenerator {
 
@@ -233,6 +235,15 @@ public abstract class ChunkGenerator {
         updateStructureSettings(structuremanager.getWorld(), structureSettings); // Spigot
         StructureStart<?> structurestart1 = structurefeature.a(this, this.b, definedstructuremanager, i, chunkcoordintpair, biomebase, j, this.structureSettings.a(structurefeature.b));
 
+        // Papercut start
+        StructureGenerateEvent event = new StructureGenerateEvent(
+            structuremanager.getWorld().getWorld(),
+            StructureType.getStructureTypes().get(structurefeature.b.i().toLowerCase()),
+            chunkcoordintpair.x,
+            chunkcoordintpair.z
+        );
+        if (event.callEvent())
+        // Papercut end
         structuremanager.a(SectionPosition.a(ichunkaccess.getPos(), 0), structurefeature.b, structurestart1, ichunkaccess);
     }
 
